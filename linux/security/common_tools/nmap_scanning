nmap
	TX - агрессивность режима работы
	-A агрессивное сканирование
	-sT - системный вызов connect
	-p выбор портов

Возможные состояния портов:
open - порт открыт и служба ожидает запросы на подключение
closed - закрытый порт не связан ни с одним приложением и может быть открыт в любой момент
filtered - брандмауэр блокирует порт и nmap не может определить, закрыт он или открыт 
unfiltered - порты отвечают на запросы, но nmap не может определить, открыты они или закрыты
open|filtered - порт либо открыт, либо фильтруется
closed|filtered - порт либо закрыт, либо фильтруется

Типы сканирования:
    Сканирование портов
    Сканирование хостов
    Сканирование на уязвимости
ICMP - Сканирование
Ping sweep - сканирование портов на отозвавшихся хостах
    nmap, Angry IP Scanner, SolarWinds Engineer's Toolset
Генерация (неправильных) пакетов
    hping2/3 
Техники TCP сканирования
    Если порт открыт, то сервер отвечает SYN+ACK, если закрыт - то RST
    SYN/ACK/FIN Scan
    Stealth Scan
        (Half-open scan) подробности ниже
    TCP connect scan
        Попытка установить подключение через three-way-handshake
        Подключение записывается в логи
        !Есть полуоткрытый вариант подключения, отправка ACK + RST в ответ на SYN/ACK
            Нет записи в логах, но менее надежно
            Если не будет отправлен RST пакет, то netstat на сервере напишет много SYN recieved
    IDLE Scan
        Сервер вообще не трогается, выбирается зомби, желательно линукс-машина, стоящая в сети и имеющая доступ к серверу и не генерирующая трафик
        IPID, нужна для сборки фрагментов, с каждым отправленным пакетом увеличивается на единицу, пингуем зомби, запоминаем его IPID, затем отправляем
        на сервер пакет, подставляя вместо себя адрес зомби, и, если порт открыт, зомби получает SYN/ACK, а если порт закрыт, то он получает RST.
        На SYN/ACK зомби тратит один IPID, т.к. он отправляет RST, если порт закрыт, то зомби молчит и не тратит IPID.
        nmap пингует зомби, а потом пингует сервер, потом пингует сервер, проверяет есть ли открытые порты, затем бинарный поиск
    NULL Scan
        Флаги не выставлены
        Принцип работы ниже
    XMAS Scan
        Можно отправить пакет с неправильно выставленными флагами, например с URG ACK RST SYN FIN
        (Три флага выставлены) (FIN, URG, PUSH с точки зрения nmap)
        FIN нужно выставлять только для ОС, с TCP/IP, поддерживающими RFC 793, если неправильный пакет приходит на открытый порт, то программа не должна отвечать,
        а если порт закрыт, то RST
        Против Шиндошс не работает, на неправильный пакет она в любом случае отвечает отправкой пакета с RST
    ACK Flag scanning
        Если шлем неожиданное подтверждение, Windows-сканирование. Либо нет ответа, либо RST
        Если есть RST, то файрволла нет, а если ответа нет, то есть firewall
    Fragment scan
        Если хорошо фрагментировать пакеты, то фильтр может и не просечь, что там в них находится
UDP-сканирование
    Если отправляем пакет, а ответа либо нет, либо это не ICMP port unreachable message, значит порт открыт
Обход IDS
    Можно фрагментировать пакет вплоть до разделения заголовка ip
    Маскировка сканирования с использованием фиктивных хостов
    -e использовать конкретный интерфейс
    -s изменить исходный адрес
    Source routing скорее всего не работает, маршрутизация данных в пакете
    (!Soft) Zenmap
    (!Soft) NetScan Tools Pro
Banner Grabbing
    Очевидно
Vulnerability Scanning
    (!Soft)Nessus
    (!Soft)XSpider
    Сканеров полно
    Можно строит диаграмму сети
Hide behind proxy
    Прокси-цепи
    Параллельное использование проксей
    Tor
    HTTP-тоннели, HTTPS
    (!Soft)HTTPtunnel
    SSH Tunneling
    SSL Proxy
IP spoofing
    Определение по IPID или TTL
        TCP Flow Control
        TCP Sequence number
Misc
    Psiphon
    Обход языковых фильтров

